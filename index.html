<!-- index.html -->

<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="//unpkg.com/katex/dist/katex.min.css" />
    <link rel="stylesheet" href="//unpkg.com/docsify/themes/vue.css" />
  </head>
  <body>
    <div id="app"></div>
    <script src="//unpkg.com/katex/dist/katex.min.js"></script>
    <script src="//unpkg.com/docsify/lib/docsify.min.js"></script>
    <script src="//unpkg.com/docsify-edit-on-github/index.js"></script>
    <script>
      window.$docsify = {
        homepage: "introduction.md",
        loadSidebar: true,
        subMaxLevel: 2,
        name: "å®žå¤åˆ†æžè®²ä¹‰",
        noCompileLinks: ["/pages/.*"],
        search: 'auto', // default
        // complete configuration parameters
        search: {
          maxAge: 86400000, // Expiration time, the default one day
          paths: 'auto',
          placeholder: 'Type to search',
          noData: 'No Results!',
          // Headline depth, 1 - 6
          depth: 6,
          hideOtherSidebarContent: false, // whether or not to hide other sidebar content
        },
        // docsify-valine (defaults)
        // uses leancloud, https://github.com/daidi/docsify-valine/
        Valine: {
          appId: 'CBnd1Cl9Yt2KP1PRyFlYi1OV-MdYXbMMI',
          appKey: '5zCsqkgRvdMn7CeHsy1wN81P'
        },
        plugins: [
          // EditOnGithubPlugin.create(
          //  "https://github.com/analysis-notes/analysis.github.io/issues/new",
          //  null,
          //  "ðŸ“è¯„è®º"
          //),
          hook => hook.afterEach(content => {
            const doc = new DOMParser().parseFromString(content, 'text/html')
            Array.from(doc.querySelectorAll('p'))
              .forEach(x => x.innerHTML = x.innerHTML.replace(/\$\$?([\s\S]*?)\$\$?/g, (all, code) => {
                const startsWith = all.startsWith('$$')
                const endsWith = all.endsWith('$$')
                // single '$' at beginning and end: small
                // double $$ at beginning and end: large 
                if((startsWith && endsWith) || (!startsWith && !endsWith)) {
                  return katex.renderToString(code, {displayMode: startsWith})
                } else {
                  console.warn('Error: mismatching dollar signs ($) in math expression, ignoring math expression')
                  return all
                }
              }))
            return doc.body.innerHTML
          })
        ]
      };
    </script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <script src="//unpkg.com/docsify-valine/dist/docsify-valine.min.js"></script>
  </body>
</html>
